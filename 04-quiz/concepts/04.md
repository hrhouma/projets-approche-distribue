Dans ce laboratoire, l’architecture utilise plusieurs services AWS, notamment **Kinesis Data Streams**, **Kinesis Data Firehose**, **Lambda**, et **OpenSearch Service**. Analysons chaque élément pour expliquer les rôles et les raisons de l’utilisation combinée de **Kinesis Data Streams** et **Firehose**, ainsi que le rôle de **Lambda**.

### Où se trouve le stockage ?
Le stockage se trouve principalement dans **Amazon OpenSearch Service**. OpenSearch Service est une plateforme qui permet de stocker, indexer et analyser les données. Les journaux des accès web générés par le serveur web sont envoyés via Firehose, transformés par Lambda, puis indexés dans **OpenSearch**. Une fois indexées, les données sont stockées de manière persistante dans OpenSearch, où elles peuvent être visualisées via **OpenSearch Dashboards**.

Bien que Firehose ne soit pas un système de stockage en soi, il est un service de livraison qui peut envoyer des données vers un stockage comme **OpenSearch**, **Amazon S3**, ou encore **Amazon Redshift**. Dans ce laboratoire, les données sont envoyées vers OpenSearch.

### Pourquoi utiliser Firehose et Streams ensemble ?

#### Kinesis Data Streams
**Kinesis Data Streams** est utilisé pour ingérer les données en **temps réel**. Il permet de gérer un flux de données important provenant du serveur web (logs d'accès). Kinesis Streams est conçu pour gérer de gros volumes de données à faible latence. L'avantage ici est que **Kinesis Data Streams** vous permet de traiter les données au fur et à mesure qu'elles arrivent en continu.

#### Kinesis Data Firehose
**Kinesis Data Firehose** est conçu pour **simplifier** la livraison des données vers des destinations comme OpenSearch Service. Il gère automatiquement la mise en buffer, la transformation des données et la livraison. Contrairement à **Streams**, **Firehose** est utilisé pour **bufferiser et livrer les données de manière plus batchée** dans des services comme OpenSearch. Firehose permet aussi de configurer directement des intégrations avec Lambda pour **transformer** les données en cours de livraison.

### Pourquoi utiliser Kinesis Data Streams avant Firehose ?
1. **Souplesse et traitement personnalisé** : Avec **Kinesis Data Streams**, vous avez plus de contrôle sur le traitement des données. Par exemple, vous pouvez configurer des consommateurs multiples comme des **Lambda** ou des **Applications Kinesis** qui lisent les données, les transforment, ou exécutent d'autres actions en temps réel.
2. **Firehose pour simplifier la livraison** : Une fois les données passées par Streams, elles sont envoyées à Firehose qui simplifie l’étape de **livraison** vers une destination (ici OpenSearch). Firehose automatise la gestion des erreurs, la mise en buffer et les transformations via Lambda.

### Pourquoi Lambda ?
**AWS Lambda** est utilisé pour **transformer** les logs d’accès avant qu’ils ne soient envoyés à OpenSearch via Firehose. Par exemple, Lambda peut enrichir les données en ajoutant des informations comme la localisation géographique de l’utilisateur, en fonction de son adresse IP. Lambda permet aussi de **nettoyer** ou **analyser** les logs en temps réel.

### Pourquoi ne pas utiliser seulement Kinesis Data Streams ?
Bien que **Kinesis Data Streams** puisse être utilisé seul pour l’ingestion de données, il ne gère pas aussi bien la **livraison des données** vers des destinations comme OpenSearch. Streams est plus flexible pour la gestion en temps réel, mais nécessite plus d'efforts pour le stockage, la gestion des erreurs, et le traitement des lots.

Firehose, en revanche, est plus simple pour **livrer des données**. Il gère automatiquement le buffering, la transformation des données (avec Lambda), et la livraison vers OpenSearch ou d'autres services, ce qui permet d'éviter d’avoir à configurer ces processus manuellement.

### Conclusion
- **Kinesis Data Streams** est utilisé pour collecter les données en temps réel et permettre un traitement flexible.
- **Firehose** est utilisé pour **bufferiser** et livrer les données dans **OpenSearch**, en simplifiant la gestion de la livraison et du traitement par lots.
- **Lambda** enrichit ou transforme les données avant qu’elles ne soient stockées.

L'usage combiné de ces services permet de traiter des **flux de données en temps réel** tout en assurant une **livraison fiable** des données vers un stockage ou une plateforme d'analyse (OpenSearch dans ce cas).
